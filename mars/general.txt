window.addEventListener('storage', (event) => {
	    if (event.storageArea === localStorage) {
	        if (event.newValue !== null) {
	            console.log(`Added: key="${event.key}", value="${event.newValue}"`);
	        } else {
	            console.log(`Removed: key="${event.key}"`);
	        }
	    }
	});





invoke
url
returnUrl
redirect_uri
offercode
bin
agentUri
reportUrl
cvolver
redirAfterLogin
redirectTo
buildUrl
redirectWithToken
administracion
fromURI
ReturnToUrl
referrer
return_url
appRedirect
state
client
protocol
response_type
scope
audience
original
urlredirect
checkout_url
lp
mrasn
redirect
referer
path
aspxerrorpath
ref
callback
next
continue
target
goto
to




serach key:
	l.params.username
	fetch
	.query.
	get("name")
	dangerouslySetInnerHTML
	__html
	innerHTML
	name:
	path:
	component:
	redirectToApp
	page.redirect
	URLSearchParams 

	window.location  
	window.location.search  
	URL.searchParams  
	fetch()  
	XMLHttpRequest  
	FormData  
	window.location.hash  
	window.location.href  
	URL.hash  




{
  "data": {
    "jwtToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.KMUFsIDTnFmyG3nMiGM6H9FNFUROf3wh7SmqJp-QV30",
    "user": {
      "id": 42,
      "email": "mahdi@gmail.com",
      "username": "mahdi"
    }
  }
}

redirectTo

jwtToken
    Gt
.send


/admin/renew-token
/admin/telemetry-properties
/auth/:authType
/usecase



https://signin.royalcanin.com/oauth2/default/v1/authorize?response_type=code&client_id=0oa2u8k0vivfLA5UI417&redirect_uri=https%3A%2F%2Fwebshop.royalcanin.com%2Fsso%2Fauthorization%2Fcallback&state=lZauHSxRrRWyAoss17jHrYfVt&scope=openid+offline_access+profile+groups
https://www.royalcanin.com/uk
https://admin.indsight.royalcanin.com/admin/auth/login





#Unrestricted Email Sending – Security Misconfiguration

## Summary:
I found a security misconfiguration in the `PUT /user/email` endpoint that allows authenticated users to send unlimited emails to **any email address** without validation or rate-limiting.

## Steps to Reproduce:
1. Login to `https://account.royalcanin.com`
2. Navigate to `Username and Password` from the sidebar or visit:
   `https://account.royalcanin.com/manager/security`
3. Click `Change Email`
4. Intercept the request to:
   `PUT /user/email` (using Burp or similar tool)
5. Replay the same request with different email addresses, repeatedly

## Supporting Material/References:
You can use the following request to reproduce:
```
PUT /user/email HTTP/2
Host: prd-weu1-rc-df-myaccount-bff.cloud-effem.com
Authorization: Bearer <your JWT>
Content-Type: application/json
...
{"newEmail":"victim@example.com","locale":"en_US"}
```

impact:
This can be abused for spam or reputation damage. It is considered a **Security Misconfiguration**, as it lacks proper restrictions or validation for email sending.




https://www.royalcanin.com/us/shop/register?redirect_uri=https%3A%2F%2Fwww.royalcanin.com&client=0oamkkuay3Bdq8tHc416&login_redirect_uri=&redirect_uri_after_registration=

https://welcome.royalcanin.com/?redirect_uri=https:%2F%2Faccount.royalcanin.com&client=0oa603wkkXHXpAa0k416&login_redirect_uri=&redirect_uri_after_registration=&_gl=1*1ko99y0*_gcl_au*MTczMDA4OTc2NS4xNzUzMTcxMzky*_ga*NjQyODE3NTM2LjE3NTMxNzEzNzg.*_ga_BYDNNWSXGT*czE3NTMxNzc4MDYkbzIkZzAkdDE3NTMxNzc4MDYkajYwJGwwJGgxNDY3Mzc0NTA.

https://www.royalcanin.com/us/shop/account/information -> different panel

https://my.royalcanin.com/signin?utm_campaign=2024-rc-us-other-other-hubProfesionalPortal&utm_source=line&utm_medium=po-affiliate-hubProfesionalPortal&_ga=2.182303015.1816165381.1699747841-1112656882.1693493334&_gl=1*u6wzl8*_gcl_au*MTg4ODIxMDMwNy4xNzUyMTQ4NTU0Ljg3MjIxMTkxOC4xNzUzMTcxNDQwLjE3NTMxNzE0NDA.*_ga*MTI3MjIyNjQ3MS4xNzUyMTQ4NTUw*_ga_BYDNNWSXGT*czE3NTMyNTAwMjMkbzEyJGcxJHQxNzUzMjUwODI5JGo2MCRsMCRoMTY0MjgyMzM5OA..


/factor/phone/sendpasscode

 this.createUserByEmail = "/lifecycle/register/custom",
            this.createUserByPhone = "/lifecycle/phone/register",
            this.resetPasswordUByPhone = "/lifecycle/phone/reset",
            this.resetPasswordUByUsername = "/lifecycle/username/reset",
            this.consentEndpoint = "/consent/users/",
            this.activateEndpoint = "/activate",
            this.setPwdEndpoint = "/set",
            this.verifyRedirectUriEndpoint = "/lifecycle/redirect_uri/verify",
            this.resetPwdEndpoint = "/reset",
            this.activationPhoneLinkEndPoint = "/lifecycle/phone/activation_link",
            this.sendPhoneCode = "/factor/phone/sendpasscode",
            this.LoginType = ji,
            this.requestForgotEmailUrl = `${this.myAccountBffUrl}/user/retrieve_email`,


WishListEmailScheduleModel
WishListModel
sendEmail




## Summary:
I found a security misconfiguration in the `PUT /us/shop/api/customer/customerBase` endpoint that allows authenticated users to change their email to any email address without validation or rate-limiting.

## Steps to Reproduce:
1. Login and go to: `https://www.royalcanin.com/us/shop/account/information`
2. Click on edit for `My Contact Information` section
3. Intercept the PUT /us/shop/api/customer/customerBase request.
4. Change the email in the request to any email you want (even if it exist)
5. Send the request — get 200 OK, email changes.
6. New email appears in shop panel

## Supporting Material/References:
You can use the following request to reproduce:
```
PUT /us/shop/api/customer/customerBase HTTP/2
Host: www.royalcanin.com
Authorization: Bearer <your JWT>
Content-Type: application/json
...
{"email":"attacker.changiz@gmail.com", ...}
```
